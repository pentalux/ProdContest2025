<!DOCTYPE html>
<html>
<head>
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
</head>
<body>
    <div class="container admin-container">
        <header class="header">
            <div class="user-header" onclick="goToProfile()">
                <div class="user-icon">‚Üê</div>
                <span class="user-title">–ù–∞–∑–∞–¥ –≤ –ø—Ä–æ—Ñ–∏–ª—å</span>
            </div>
        </header>

        <main class="main-content">
            <div class="admin-header">
                <h2>üëë –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
                <span class="user-info">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: {{ user.first_name }} {{ user.last_name }}</span>
            </div>

            <div class="admin-actions">
                <button class="admin-action-btn" onclick="openSubscriptionsAdmin()">‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏</button>
                <button class="admin-action-btn" onclick="goToProfile()">üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</button>
            </div>

            <div class="stats">
                <strong>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</strong>
                <div>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {{ users|length }}</div>
                <div>–û–±—â–∏–π –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {{ users|sum(attribute='user_balance') }} —Ä—É–±.</div>
                <div>–û–±—â–∏–π –±–∞–ª–∞–Ω—Å –Ω–∞ —Å–∞–π—Ç–µ: {{ users|sum(attribute='site_balance') }} —Ä—É–±.</div>
            </div>

            {% if users %}
            <div style="overflow-x: auto;">
                <table class="users-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–§–ò–û</th>
                            <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                            <th>Telegram ID</th>
                            <th>–ü–æ–¥–ø–∏—Å–∫–∞</th>
                            <th>–ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                            <th>–ë–∞–ª–∞–Ω—Å –Ω–∞ —Å–∞–π—Ç–µ</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for user_item in users %}
                        <tr>
                            <td>{{ user_item.unique_id }}</td>
                            <td>{{ user_item.last_name }} {{ user_item.first_name }} {{ user_item.middle_name or '' }}</td>
                            <td>{{ user_item.phone_number }}</td>
                            <td>{{ user_item.telegram_id }}</td>
                            <td>
                                <span class="subscription-badge {{ user_item.subscription.level|lower }}">
                                    {{ user_item.subscription.level }}
                                </span>
                            </td>
                            <td>{{ user_item.user_balance }} —Ä—É–±.</td>
                            <td>{{ user_item.site_balance }} —Ä—É–±.</td>
                            <td>
                                <button class="edit-btn" onclick="editUser('{{ user_item.unique_id }}')">
                                    ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="user-info-card">
                <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
            </div>
            {% endif %}
        </main>
    </div>

    <script>
        const userId = "{{ user.unique_id }}";
    </script>
    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
</body>
</html>